var h=this;function n(a,b){var c=a.split("."),d=h;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b};Framework={I:{},$a:!1};Framework.a=Backbone.View.extend({template:null,Cb:!1,hb:function(){for(var a in this.J)this.J[a].destroy()},initialize:function(a){this.J={};a||(a={});this.kb=a;if(this.Sa)for(var b in this.Sa)this[this.Sa[b]]=this.getParameter(b);_.bindAll(this,"render","destroy");var c=this;this.render=_.wrap(this.render,function(a,b){a(b);c.ob();return c});this.destroy=_.wrap(this.destroy,function(a,b,f,g){a(b,f,g);return c})},ja:function(a,b){var c=function(c,d){b=b?b:{};b._this=this;b._options=this.kb;this._preloadData=
d;b._preloadData=d;this.$el.html(_.template(c)(b));this.render();a&&a()}.bind(this);if(null!=this.template)if(Framework.I[this.template])this.preloadDataAsync(function(a){c(Framework.I[this.template],a)},function(){c("ERROR in preloadDataAsync",{})});else{var d=function(a){Framework.$a&&(Framework.I[this.template]=a);this.preloadDataAsync(function(b){c(a,b)},function(){c("ERROR in preloadDataAsync",{})})}.bind(this);$.ajax({url:this.template,method:"GET",success:d,error:function(){this.$el.html("template ["+
this.template+"] failed to load.")}.bind(this)})}else this.preloadDataAsync(function(){this.render()}.bind(this),function(){this.$el.html("ERROR in preloadDataAsync")}.bind(this)),a&&a()},render:function(){return this},ob:function(){this.Cb=!0},Wb:function(){},Vb:function(){}});n("Framework.BaseView",Framework.a);
Framework.a.prototype.R=function(a,b,c){this.Ka||(this.Ka=[]);a=$.ajax({headers:{Za:"application/json"},cache:!1,contentType:"application/json",type:"GET",processData:!1,url:a,success:b,error:c});this.Ka.push(a)};Framework.a.prototype.getJSON=Framework.a.prototype.R;Framework.a.prototype.getParameter=function(a){var b=location.hash;if(0==b.length)return null;for(var b=b.substr(1).split("&"),c=0,d=b.length;c<d;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}return null};
Framework.a.prototype.getParameter=Framework.a.prototype.getParameter;Framework.a.prototype.na=function(a,b){var c=location.hash;0==c.length&&(c="#");c=c.substr(1).split("&");""==c[0]&&(c=[]);for(var d=!1,e=0,f=c.length;e<f;e++)if(c[e].split("=")[0]==a){c[e]=b?a+"="+b:"";d=!0;break}!d&&b&&c.push(a+"="+b);d=[];e=0;for(f=c.length;e<f;e++)c[e]&&d.push(c[e]);location.hash="#"+d.join("&")};Framework.a.prototype.setParameter=Framework.a.prototype.na;
Framework.a.prototype.destroy=function(){this.hb();this.undelegateEvents();this.b&&this.b.J[this.cid]&&delete this.b.J[this.cid];this.$el.removeData().unbind();this.dc?(this.$el.empty(),this.stopListening()):this.remove();this.trigger("destroy",this)};Framework.a.prototype.destroy=Framework.a.prototype.destroy;
Framework.a.prototype.C=function(a,b){this.Eb?(this.$el.html(this.Eb),this.ja(a,b)):this.N?Framework.I[this.N]?(this.$el.html(Framework.I[this.N]),this.ja(a,b)):(this.$el.html(""),$.ajax({url:this.N,method:"GET",success:function(c){Framework.I[this.N]=c;this.C(a,b)}.bind(this),error:function(){Framework.I[this.N]="Loading Template ["+this.N+"] failed to load.";this.C(a,b)}.bind(this)})):this.ja(a,b)};Framework.a.prototype.renderView=Framework.a.prototype.C;
Framework.a.prototype.sa=function(a,b,c){c=c?c:{};this[a]=new b(c);this.J[this[a].cid]=this[a];this[a].b=this;this[a].Zb=a;return this[a]};Framework.a.prototype.instantiateView=Framework.a.prototype.sa;Framework.a.prototype.sb=function(a,b){b=b?b:{};var c=new a(b);this.J[c.cid]=c;c.b=this;return c};Framework.a.prototype.instantiate=Framework.a.prototype.sb;Framework.a.prototype.ma=function(){return this.b};Framework.a.prototype.getParent=Framework.a.prototype.ma;Framework.a.prototype.pa=function(){return this.J};
Framework.a.prototype.getChildren=Framework.a.prototype.pa;Framework.a.prototype.preloadDataAsync=function(a){a({})};Framework.f=Backbone.View.extend({type:"GET",initialize:function(){this.B={}},Ba:function(a,b){this.sort||(this.sort={});this.sort.name=a;this.sort.Ra=b},ec:function(){return this.sort},ga:function(a){this.va=a+1},O:function(a){this.wa=a}});n("Framework.AbstractConstraintModel",Framework.f);Framework.V=Framework.f.extend({type:"POST"});n("Framework.PostConstraintModel",Framework.V);Framework.V.prototype.Oa=function(){throw"must override getBody";};Framework.V.prototype.getBody=Framework.V.prototype.Oa;
Framework.f.prototype.intersection=function(a){var b=new this.constructor;this.sort&&b.Ba(this.sort.name,this.sort.Ra);a.sort&&b.Ba(a.sort.name,a.sort.Ra);this.mb&&b.O(this.wa);this.lb&&b.ga(this.va);a.mb&&b.O(a.wa);a.lb&&b.ga(a.va);a.sort&&b.Ba(a.sort);for(var c in this.B)b.B[c]=this.B[c];for(c in a.B)b.B[c]=a.B[c];return b};Framework.f.prototype.intersection=Framework.f.prototype.intersection;Framework.f.prototype.pa=function(a,b){this.B[a]=b};Framework.f.prototype.setField=Framework.f.prototype.pa;
Framework.f.prototype.R=function(a){return this.B[a]};Framework.f.prototype.getField=Framework.f.prototype.R;Framework.f.prototype.getUrl=function(){return"override me"};Framework.f.prototype.ma=function(){return this.va};Framework.f.prototype.getPageNumber=Framework.f.prototype.ma;Framework.f.prototype.na=function(){return this.wa};Framework.f.prototype.getPageSize=Framework.f.prototype.na;Framework.m=Framework.a.extend({initialize:function(a){Framework.a.prototype.initialize.call(this,a);this.source=a.source;this.source.subscribe(this)},destroy:function(){this.source.unsubscribe(this);Framework.a.prototype.destroy.call(this)}});n("Framework.AbstractConstraintPanel",Framework.m);Framework.m.prototype.getConstraintModel=function(){return new this.source.ConstraintModelPrototype};Framework.m.prototype.R=function(){return this.source};Framework.m.prototype.getSource=Framework.m.prototype.R;
Framework.m.prototype.v=function(){this.trigger("constraintPanel:changed",this)};Framework.m.prototype.onConstraintChange=Framework.m.prototype.v;Framework.Ca=Framework.a.extend({events:{"click #clear":"onClear","click #selectAll":"onSelectAll","click #indicator":"onIndicator","click #clearOnPage":"onClearOnPage","click #clearOnPageAll":"onClearOnPage"},lc:function(){console.log("on indicator")},Gb:function(){this.b.Ma()},gc:function(){this.b.qb()},uc:function(){this.b.Qb()},da:[],Rb:"selected",update:function(){this.b.source.getAll(null,function(a){var b=Object.keys(this.b.h).length;this.$("#indicator, #selectAll, #clear, #clearOnPage, #clearOnPageAll, .fw-rsp-at-least-one").hide();
0<b&&(this.$("#indicator, .fw-rsp-at-least-one").show(),this.$("#indicator").html(b+" "+this.Rb),this.$("#clear").show());for(var c=!0,d=!0,e=a.length-1;0<=e&&(d||c);e--)this.b.h[a[e][this.b.id]]?d=!1:c=!1;0<a.length&&(d?this.$("#selectAll").show():d||c||this.$("#clearOnPage").show(),c&&this.$("#clearOnPageAll").show());this.pb&&this.pb(this.b.h,b)}.bind(this))},initialize:function(a){this.options=a?a:{};this.b=this.options.parent},render:function(){this.callbacks={};this.ua={};this.$("#indicator, #clear, #clearOnPage, #clearOnPageAll, .fw-rsp-at-least-one").hide();
for(var a=0,b=this.da.length;a<b;a++){var c=this.da[a].id;this.callbacks[c]=this.da[a].Z;this.ua[c]=this.da[a].ua;this.$(c).on("click",function(a){a="#"+$(a.currentTarget)[0].id;this.callbacks[a](this.b.h,this);this.ua[a]||this.Gb()}.bind(this))}}});n("Framework.AbstractRecordSelectionPanel",Framework.Ca);Framework.T=Framework.m.extend({name:"abstractViewer",xc:"uuid",events:{keyup:"onKeyup",dragover:"onDragover",dragenter:"onDragenter",drop:"onDrop",mousedown:"onMousedown",mouseup:"onMouseup","mouseover .fw-record":"onMouseover","mouseleave .fw-record":"onMouseleave","mousedown .fw-record":"onClick","change .fw-checkbox":"toggleCheckbox",mousemove:"onMousemove",mouseleave:"onMouseup"},jc:function(a){a.preventDefault();a.stopPropagation()},ic:function(a){a.preventDefault();a.stopPropagation()},kc:function(a){a.originalEvent.dataTransfer&&
a.originalEvent.dataTransfer.files.length&&(a.preventDefault(),a.stopPropagation(),this.trigger("files",a.originalEvent.dataTransfer.files))},mc:function(){},Ga:function(a,b,c){this.$(".fw-record").removeClass("fw-row-selected");c?this.trigger("unselected"):(a.addClass("fw-row-selected"),this.trigger("selected",b))},hc:function(a){var b=$(a.currentTarget),c=$(a.target);if(c.hasClass("fw-checkbox-specific")||c.hasClass("k6-action"))return!0;var c=b.data("id"),d=this.W(c),e=Date.now();this.P?this.P.id==
c&&400>e-this.P.time?(this.trigger("dblclick",d),this.P=null):(this.b.fa&&this.Ga(b,d,a.ctrlKey),this.trigger("click",d),this.P={id:c,Nb:d,time:e}):(this.P={id:c,Nb:d,time:e},this.b.fa&&this.Ga(b,d,a.ctrlKey),this.trigger("click",d))},Ib:function(a){if(this.g){this.g.ia.css({width:Math.max(a.clientX,this.g.x)-Math.min(a.clientX,this.g.x),height:Math.max(a.clientY,this.g.y)-Math.min(a.clientY,this.g.y),left:a.clientX<this.g.x?a.clientX:this.g.x,top:a.clientY<this.g.y?a.clientY:this.g.y});a=this.$(".fw-record");
this.g.ctrlKey||(a.removeClass("fw-selected"),this.parent.h={});for(var b=this.g.ia[0].getBoundingClientRect(),c=0,d=a.length;c<d;c++){var e=a[c],f=e.getBoundingClientRect();if(!(f.right<b.left||f.left>b.right||f.bottom<b.top||f.top>b.bottom)){var e=$(e),f=e.data("id"),g={};g[this.parent.id]=f;g=_.findWhere(this.Y,g);this.parent.h[f]=g;e.addClass("fw-selected")}}this.trigger("viewer:change");this.parent.trigger("selectionChanged")}},nc:function(a){if(this.b&&"drag"==this.b.H){var b=$("<div>");this.g=
{x:a.clientX,y:a.clientY,ia:b,ctrlKey:a.ctrlKey};b.css({position:"fixed",left:this.g.x+"px",top:this.g.y+"px",width:"1px",height:"1px",border:"2px solid yellow"});this.$el.append(b);a=b[0].getBoundingClientRect();for(var c=this.$(".fw-selected"),d=0,e=c.length;d<e;d++){var f=c[d],g=f.getBoundingClientRect();g.right<a.left||g.left>a.right||g.bottom<a.top||g.top>a.bottom||(f=$(f),g=f.data("id"),this.g.ctrlKey&&(f.removeClass("fw-selected"),delete this.parent.h[g],this.g=null,b.remove(),this.trigger("viewer:change"),
this.parent.trigger("selectionChanged")))}}},qc:function(a){this.Ib(a);this.g&&this.g.ia.remove();this.g=null},pc:function(a){a=$(a.currentTarget).data("id");this.trigger("mouseover",this.W(a))},oc:function(a){a=$(a.currentTarget).data("id");this.trigger("mouseleave",this.W(a))},focus:function(){console.log("focus not implemented")},$b:function(){},W:function(a){for(var b=0,c=this.Y.length;b<c;b++)if(this.Y[b][this.parent.id]==a)return this.Y[b];return null},zc:function(a){a.originalEvent.preventDefault();
a=$(a.currentTarget);var b=a.data("id");a.prop("checked")?this.parent.h[b]=this.W(b):delete this.parent.h[b];this.trigger("viewer:change");this.parent.trigger("selectionChanged");return!1},Kb:function(){this.$(".abstract-viewer-overlay").remove();this.$el.append('<div class="abstract-viewer-overlay"></div>')},wc:function(){this.$(".abstract-viewer-overlay").remove()},Qa:function(){this.Kb()},render:function(){"drag"==this.b.H&&this.$el.css({"-webkit-touch-callout":"none","-webkit-user-select":"none",
"-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},initialize:function(a){a=a?a:{};Framework.m.prototype.initialize.call(this,a);this.A=a.A;this.parent=a.parent},eb:function(){"checkbox"!=this.parent.H&&this.$(".fw-checkbox-specific").remove();if(this.b.la)for(var a=this.$(".fw-record"),b=0,c=a.length;b<c;b++){var d=$(a[b]),e=d.data("id");this.b.la==e&&d.addClass("fw-row-selected")}if("drag"==this.parent.H)for(a=this.$(".fw-record"),b=0,c=a.length;b<
c;b++)d=$(a[b]),e=d.data("id"),this.parent.h[e]&&d.addClass("fw-selected");else if("checkbox"==this.parent.H)for(a=this.$(".fw-checkbox"),b=0,c=a.length;b<c;b++)d=$(a[b]),e=d.data("id"),this.parent.h[e]&&(d.addClass("fw-selected"),d.attr("checked","true"));this.Na=!1},show:function(a){this.Y=records;this.C(this.eb.bind(this),{h:this.parent.h,data:a,id:this.parent.id,A:this.parent.A,selected:this.parent.Yb,fa:this.b.fa,H:this.parent.H})}});n("Framework.AbstractViewer",Framework.T);
Framework.Fa=Framework.T.extend({initialize:function(a){Framework.T.prototype.initialize.call(this,a);this.listenTo(this.source,"source:constraintChange",this.v);this.listenTo(this.source,"source:refresh",this.v)},v:function(){this.C()}});n("Framework.Viewer",Framework.Fa);Framework.Fa.prototype.preloadDataAsync=function(a){this.Qa();this.source.get(a)};$.fn.xa=function(a,b){b=$.extend({i:10,ea:10,w:0,G:0,Db:"#",za:"Prev",ta:"Next",ba:"...",Mb:!1,Fb:!1,Z:function(){return!1}},b||{});this.each(function(){function c(){var c=Math.ceil(b.ea/2),d=Math.ceil(a/b.i),e=d-b.ea;return[f>c?Math.max(Math.min(f-c,e),0):0,f>c?Math.min(f+c,d):Math.min(b.ea,d)]}function d(a,c){f=a;e();var d=b.Z(a,g);d||(c.stopPropagation?c.stopPropagation():c.cancelBubble=!0);return d}function e(){function e(a,c){a=0>a?0:a<m?a:m-1;c=$.extend({text:a+1,aa:""},c||{});var d=a==f?$("<li class='active'><a href='#'>"+
c.text+"</a></li>"):$("<li><a>"+c.text+"</a></li>").bind("click",p(a)).attr("href",b.Db.replace(/__id__/,a));c.aa&&d.addClass(c.aa);g.append(d)}function p(a){return function(b){return d(a,b)}}g.empty();var l=c(),m=Math.ceil(a/b.i);b.za&&(0<f||b.Mb)&&e(f-1,{text:b.za,aa:"prev"});if(0<l[0]&&0<b.G){for(var q=Math.min(b.G,l[0]),k=0;k<q;k++)e(k);b.G<l[0]&&b.ba&&$("<li class='disabled'><a href='#'>"+b.ba+"</a></li>").appendTo(g)}for(k=l[0];k<l[1];k++)e(k);if(l[1]<m&&0<b.G)for(m-b.G>l[1]&&b.ba&&$("<li class='disabled'><a href='#'>"+
b.ba+"</a></li>").appendTo(g),k=Math.max(m-b.G,l[1]);k<m;k++)e(k);b.ta&&(f<m-1||b.Fb)&&e(f+1,{text:b.ta,aa:"next"})}var f=b.w;a=!a||0>a?1:a;b.i=!b.i||0>b.i?1:b.i;var g=$(this);this.nextPage=function(){return f<Math.ceil(a/b.i)-1?(d(f+1),!0):!1};e();b.Z(f,this)})};Framework.U=Framework.m.extend({bb:[10,20,30,50,100,1E3],ab:10,Wa:null,events:{"click [id^='pageSize_']":"onPageSize","click #nextPage":"onNextPage","click #previousPage":"onPreviousPage"},sc:function(a){this.O(a.currentTarget.id.split("_")[1]);this.v()},O:function(a){this.$("#itemsPerPage").html(a);this.s.w=0;this.s.i=Number(a);this.$("#paginationPanel").xa(this.source.D(),this.s)},reset:function(){this.s.w=0;this.$("#paginationPanel").xa(this.source.D(),this.s)},ra:function(a){this.s.w!=a&&(this.s.w=
a,this.v())},qa:function(){this.j=new this.source.ConstraintModelPrototype;this.j.O(this.s.i);this.j.ga(this.s.w);return this.j},initialize:function(a){Framework.m.prototype.initialize.call(this,a);this.options=a?a:{};this.i=a.i;this.S=a.S;this.S||(this.S=this.bb);this.i||(this.i=this.ab);this.s={Z:this.ra.bind(this),w:0,za:"",ta:"",i:this.i,ea:4,G:1};this.listenTo(this.source,"source:constraintChange",this.update);this.listenTo(this.source,"source:refresh",this.update)},fc:function(){var a=this.$("#itemsPerPageMenu");
a.empty();for(var b=0,c=this.S.length;b<c;b++){var d=this.S[b],d=$('<li><a id="pageSize_'+d+'" role="menuitem">'+d+"</a></li>");a.append(d)}this.$("#itemsPerPage").html(this.i)},rc:function(){this.ra(this.s.w+1)},tc:function(){this.ra(this.s.w-1)},update:function(){this.source.getAll(null,function(){this.$("#previousPage,#nextPage").css("visibility","visible");var a=this.s.w;0==a&&this.$("#previousPage").css("visibility","hidden");var b=Number(this.s.i),c=this.source.D(),d=(a+1)*b,d=d>c?c:d,a=1+a*
b,a=a>c?c:a;d==c&&this.$("#nextPage").css("visibility","hidden");d=a+"-"+d+" OF "+c;this.Wa&&(d+=" IN "+this.Wa);this.$("#paginationPanel").xa(this.source.D(),this.s);this.$("#paginationCount").html(d);0==c?this.$("#paginationCount").css("visibility","hidden"):this.$("#paginationCount").css("visibility","visible")}.bind(this))},C:function(a,b){var c=function(){this.$el.html("unable to get count for paginationPanel")}.bind(this);this.source.getAll(null,function(){Framework.m.prototype.C.call(this,
function(){this.update();a&&a()}.bind(this),b)}.bind(this),c)}});n("Framework.PaginationPanel",Framework.U);
Framework.Ea=Framework.U.extend({events:{"click #more":"_more"},fb:function(a){var b=$(window).height(),c=$(window).scrollTop(),d=$(a).offset().top;a=$(a).height();return d<1.2*(b+c)&&d>c-a},initialize:function(a){Framework.m.prototype.initialize.call(this,a);setInterval(this.jb.bind(this),500)},Ua:function(){},qa:function(){this.j=new this.source.ConstraintModelPrototype;this.j.O(this.Da);this.j.ga(this.nextPage);return this.j},Ja:function(){this.source.getAll(null,function(){this.source.D()<=(this.nextPage+
1)*this.Da?this.$el.hide():this.ka=!1}.bind(this))},ib:function(){this.nextPage++;this.v();this.Ja()},jb:function(){0<this.$("#more").length||!this.fb(this.el)||this.ka||(this.ka=!0,this.ib())},update:function(){},reset:function(){this.ka=!1;this.nextPage=0;this.$el.show()},render:function(){this.Ja()},Da:8,nextPage:0});n("Framework.ScrollPaginationPanel",Framework.Ea);Framework.o=Backbone.View.extend({dataType:"json",url:null,initialize:function(){this.j=new this.ConstraintModelPrototype;this.M={};this.u={};this.cache={};this.oa={};this.Lb={};this.X={};this.Pa=!1;if(!this.url)throw"this.url must be defined";},subscribe:function(a){this.M[a.cid]=a;a instanceof Framework.Ea&&(this.gb=!0);this.listenTo(a,"constraintPanel:changed",this.Hb)},unsubscribe:function(a){delete this.M[a.cid]},Ua:function(a){this.j=a;for(var b in this.M)this.M[b].Ua(this.j)},Ha:function(a){var b=
new this.ConstraintModelPrototype,c;for(c in this.M){var d=this.M[c];a&&d instanceof Framework.U&&(this.K=null,d.reset());b=b.intersection(d.getConstraintModel())}return b},Hb:function(a){var b=!(a instanceof Framework.U);b&&(this.K=null);b=this.Ha(b);this.Tb(b,a)},bc:function(){this.cache={}},Tb:function(a,b){this.Sb(a);this.trigger("source:constraintChange",b)},Sb:function(a){this.j=a;"POST"==this.ConstraintModelPrototype.prototype.type?this.ya=JSON.stringify(a.Oa()):this.j.getUrl()},D:function(){return this.count},
getAll:function(a,b,c){a="";(this.j=this.Ha())&&"GET"==this.ConstraintModelPrototype.prototype.type&&(a="?"+this.j.getUrl());var d=this.url+a;this.oa[d]&&(this.count=this.oa[d]);null==this.cache[d]||this.Ia&&this.Ia!=this.ya?this.X[d]?(this.u[d]||(this.u[d]=[]),this.u[d].push(b)):(this.X[d]=!0,this.u[d]=[],this.u[d].push(b),this.L&&(this.L.url&&(this.u[d]=this.u[this.L.url].concat(this.u[d]),delete this.u[this.L.url]),this.L.abort()),this.L=$.ajax({headers:{Za:"application/json"},cache:!1,contentType:"application/json",
type:this.cc,processData:!1,url:d,dataType:this.dataType,data:this.ya,success:function(a){this.Pa||(this.Lb[d]=a);this.Aa&&this.Aa(a);if(this["parse__"+this.url])this["parse__"+this.url](a);else this.parse&&(a=this.parse(a));var b=function(a){this.X[d]=!1;this.gb&&(this.K||(this.K=[]),a=this.K=this.K.concat(a));this.Ia=this.ya;this.Pa||(this.cache[d]=a,this.oa[d]=this.count);for(var b=0,c=this.u[d].length;b<c;b++)this.u[d][b](a);this.u[d]=[]}.bind(this);if(this["parseAsync__"+this.url])this["parse__"+
this.url](a);else this.parseAsync?this.parseAsync(a,function(a){b(a)}.bind(this)):b(a)}.bind(this),error:function(a){this.X[d]=!1;"abort"!=a.statusText&&(c?c(a):(console.log("error:"),console.log(a)))}.bind(this)}),this.L.url=d):b(this.cache[d])},destroy:function(){console.log("destroying source")},refresh:function(){this.cache={};this.trigger("source:refresh")}});n("Framework.RestSource",Framework.o);Framework.o.prototype.qa=function(){return this.j};Framework.o.prototype.getConstraintModel=Framework.o.prototype.qa;
Framework.o.prototype.ConstraintModelPrototype=Framework.f;Framework.o.prototype.get=function(a,b){this.getAll(null,a,b)};Framework.o.prototype.get=Framework.o.prototype.get;Framework.o.prototype.Aa=function(a){this.count=a};Framework.o.prototype.setCount=Framework.o.prototype.Aa;Framework.o.prototype.D=function(){return this.count};Framework.o.prototype.getCount=Framework.o.prototype.D;Framework.cb=Framework.a.extend({el:"#sourceView",Ob:null,c:[Framework.T],Pb:Framework.Ca,id:"uuid",F:"undefined",H:"checkbox",ac:{},fa:!1,A:null,initialize:function(a){a=a?a:{};this.h={};Framework.a.prototype.initialize.call(this,a);a.F&&(this.F=a.F);this.A=a.A;this.source=a.source;this.La=a.La;this.sa("recordSelectionPanel",this.Pb);this.source&&(this.listenTo(this.source,"source:constraintChange",this.v),this.listenTo(this.source,"source:refresh",function(){this.v(!0)}.bind(this)));for(a=this.c.length-
1;0<=a;a--)this.sa(this.c[a].prototype.name,this.c[a],{h:this.h,A:this.A,parent:this,source:this.source}),this.listenTo(this[this.c[a].prototype.name],"dblclick",this.vb),this.listenTo(this[this.c[a].prototype.name],"click",this.ub),this.listenTo(this[this.c[a].prototype.name],"selected",this.zb),this.listenTo(this[this.c[a].prototype.name],"unselected",this.Ab),this.listenTo(this[this.c[a].prototype.name],"files",this.wb),this.listenTo(this[this.c[a].prototype.name],"mouseover",this.yb),this.listenTo(this[this.c[a].prototype.name],
"mouseleave",this.xb),this.listenTo(this[this.c[a].prototype.name],"viewer:change",this.ca),this.listenTo(this[this.c[a].prototype.name],"viewer:setRecord",this.Bb);if(!this[this.F]&&0<this.c.length){if(this.F)throw"unresolved initialView: "+this.F;throw"initial view must be either passed in the viewer or defined in the extended view i.e: window.YourView = SourceView.extend({ initialView : 'grid' }) // where 'grid' resolves to GridViewer.prototype.name";}},yb:function(a){this.trigger("mouseover",
a)},xb:function(a){this.trigger("mouseleave",a)},vb:function(a){this.trigger("dblclick",a)},ub:function(a){this.trigger("click",a)},wb:function(a){this.trigger("files",a)},zb:function(a){this.la=a[this.id];this.$("#viewer_holder").focusin();this.trigger("selected",a)},Ab:function(){this.la=null;this.trigger("unselected")},Bb:function(a){this.rb=a;this.trigger("viewer:setRecord",a)},rb:null,yc:function(a){this.A=a;this.v()},Qb:function(){this.source.getAll(null,function(a){for(var b=a.length-1;0<=
b;b--)this.h[a[b][this.id]]=a[b];this.ca();this.l&&this.l.show(a);this.trigger("selectionChanged")}.bind(this))},Ma:function(){for(var a in this.h)delete this.h[a];this.trigger("selectionCleared");this.nb()},nb:function(){this.ca();this.source&&this.source.getAll(null,function(a){this.l&&this.l.show(a)}.bind(this))},qb:function(){this.source.getAll(null,function(a){for(var b=a.length-1;0<=b;b--)delete this.h[a[b][this.id]];this.ca();this.l.show(a)}.bind(this))},v:function(a){this.Xb||(this.La&&this.Ma(),
this.l&&(this.l.Qa(),this.$("#viewerProgressBar").show(),this.source.getAll(null,function(b){this.$("#viewerProgressBar").hide();this.Va.update();this.l.show(b);a&&this.l.$(".fw-row-selected").trigger("mousedown");this.Xa()}.bind(this))))},render:function(){var a=$('<div id="viewer_holder" tabindex="1" style="outline:none;position: relative; height: 100%;width:100%;overflow-x: hidden;overflow-y: hidden; display: block;">');this.$el.empty();this.$el.append('<div id="viewerProgressBar" class="progress" style="display:none;margin-bottom: -6px;margin-top: 2px;"><div class="indeterminate"></div></div>');
this.$el.append(a);for(var b=this.c.length-1;0<=b;b--){var c=$('<div style="height: 100%;" id="'+this.c[b].prototype.name+'" class="record_viewer"></div>');a.append(c);this[this.c[b].prototype.name].setElement(c)}$el=this.Ob;$el||($el=$('<div id="viewerRecordSelectionPanelEl">'),this.$el.prepend($el));this.Va.setElement($el).C();this.tb(this.F);this.Ta={};$(document).on("keydown",function(a){a=a||window.event;this.Ta[a.keyCode]=!0}.bind(this));$(document).on("keyup",function(a){a=a||window.event;
delete this.Ta[a.keyCode]}.bind(this))},ca:function(){this.Va.update();this.Xa()},tb:function(a){this.Ya(a);this.l&&this.l.focus()},Xa:function(){for(var a=this.c.length-1;0<=a;a--)this.l!=this[this.c[a].prototype.name]&&(this[this.c[a].prototype.name].Na=!0)},Ya:function(a){this.l=this[a];for(var b=this.c.length-1;0<=b;b--)this.$("#"+this.c[b].prototype.name).hide();this.$("div#"+a).show();this.l&&this.l.Na&&this.source.getAll(null,function(a){this.l.show(a)}.bind(this));this.trigger("sourceView:change",
a)}});n("Framework.SourceView",Framework.cb);Framework.Ub=Framework.a.extend({initialize:function(a){Framework.a.prototype.initialize.call(this,a);this.ha=a.ha;if(!this.ha)throw"you must specify sourceView parameter in options.";this.listenTo(this.ha,"sourceView:change",this.Jb)},Jb:function(){},events:{"click .view-toggle":"onViewToggle"},vc:function(a){a=$(a.currentTarget).data("viewer");this.ha.Ya(a)},render:function(){}});
