var h=this;function n(a,b){var c=a.split("."),d=h;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b};Framework={K:{},eb:!1};Framework.a=Backbone.View.extend({template:null,Gb:!1,lb:function(){for(var a in this.L)this.L[a].destroy()},initialize:function(a){this.L={};a||(a={});this.la=a;if(this.Wa)for(var b in this.Wa)this[this.Wa[b]]=this.getParameter(b);_.bindAll(this,"render","destroy");var c=this;this.render=_.wrap(this.render,function(a,b){a(b);c.sb();return c});this.destroy=_.wrap(this.destroy,function(a,b,f,g){a(b,f,g);return c})},ma:function(a,b){var c=function(c,d){b=b?b:{};b._this=this;b._options=this.la;this._preloadData=
d;b._preloadData=d;this.$el.html(_.template(c)(b));this.render();a&&a()}.bind(this);if(null!=this.template)if(Framework.K[this.template])this.preloadDataAsync(function(a){c(Framework.K[this.template],a)},function(){c("ERROR in preloadDataAsync",{})});else{var d=function(a){Framework.eb&&(Framework.K[this.template]=a);this.preloadDataAsync(function(b){c(a,b)},function(){c("ERROR in preloadDataAsync",{})})}.bind(this);$.ajax({url:this.template,method:"GET",success:d,error:function(){this.$el.html("template ["+
this.template+"] failed to load.")}.bind(this)})}else this.preloadDataAsync(function(){this.render()}.bind(this),function(){this.$el.html("ERROR in preloadDataAsync")}.bind(this)),a&&a()},render:function(){return this},sb:function(){this.Gb=!0},ac:function(){},$b:function(){}});n("Framework.BaseView",Framework.a);
Framework.a.prototype.F=function(a,b,c){this.Oa||(this.Oa=[]);a=$.ajax({headers:{cb:"application/json"},cache:!1,contentType:"application/json",type:"GET",processData:!1,url:a,success:b,error:c});this.Oa.push(a)};Framework.a.prototype.getJSON=Framework.a.prototype.F;Framework.a.prototype.wb=null;Framework.a.prototype.loadingTemplate=Framework.a.prototype.wb;
Framework.a.prototype.getParameter=function(a){var b=location.hash;if(0==b.length)return null;for(var b=b.substr(1).split("&"),c=0,d=b.length;c<d;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}return null};Framework.a.prototype.getParameter=Framework.a.prototype.getParameter;
Framework.a.prototype.setParameter=function(a,b){var c=location.hash;0==c.length&&(c="#");c=c.substr(1).split("&");""==c[0]&&(c=[]);for(var d=!1,e=0,f=c.length;e<f;e++)if(c[e].split("=")[0]==a){c[e]=b?a+"="+b:"";d=!0;break}!d&&b&&c.push(a+"="+b);d=[];e=0;for(f=c.length;e<f;e++)c[e]&&d.push(c[e]);location.hash="#"+d.join("&")};Framework.a.prototype.setParameter=Framework.a.prototype.setParameter;
Framework.a.prototype.destroy=function(){this.lb();this.undelegateEvents();this.b&&this.b.L[this.cid]&&delete this.b.L[this.cid];this.$el.removeData().unbind();this.ic?(this.$el.empty(),this.stopListening()):this.remove();this.trigger("destroy",this)};Framework.a.prototype.destroy=Framework.a.prototype.destroy;
Framework.a.prototype.B=function(a,b){this.Ib?(this.$el.html(this.Ib),this.ma(a,b)):this.loadingTemplate?Framework.K[this.loadingTemplate]?(this.$el.html(Framework.K[this.loadingTemplate]),this.ma(a,b)):(this.$el.html(""),$.ajax({url:this.loadingTemplate,method:"GET",success:function(c){Framework.K[this.loadingTemplate]=c;this.B(a,b)}.bind(this),error:function(){Framework.K[this.loadingTemplate]="Loading Template ["+this.loadingTemplate+"] failed to load.";this.B(a,b)}.bind(this)})):this.ma(a,b)};
Framework.a.prototype.renderView=Framework.a.prototype.B;Framework.a.prototype.da=function(a,b,c){c=c?c:{};this[a]=new b(c);this.L[this[a].cid]=this[a];this[a].b=this;this[a].dc=a;return this[a]};Framework.a.prototype.instantiateView=Framework.a.prototype.da;Framework.a.prototype.sa=function(a,b){b=b?b:{};var c=new a(b);this.L[c.cid]=c;c.b=this;return c};Framework.a.prototype.instantiate=Framework.a.prototype.sa;Framework.a.prototype.pa=function(){return this.b};Framework.a.prototype.getParent=Framework.a.prototype.pa;
Framework.a.prototype.qa=function(){return this.L};Framework.a.prototype.getChildren=Framework.a.prototype.qa;Framework.a.prototype.preloadDataAsync=function(a){a({})};Framework.f=Backbone.View.extend({type:"GET",initialize:function(){this.D={}},Da:function(a,b){this.sort||(this.sort={});this.sort.name=a;this.sort.Va=b},jc:function(){return this.sort},ia:function(a){this.xa=a+1},P:function(a){this.ya=a}});n("Framework.AbstractConstraintModel",Framework.f);Framework.V=Framework.f.extend({type:"POST"});n("Framework.PostConstraintModel",Framework.V);Framework.V.prototype.Sa=function(){throw"must override getBody";};Framework.V.prototype.getBody=Framework.V.prototype.Sa;
Framework.f.prototype.intersection=function(a){var b=new this.constructor;this.sort&&b.Da(this.sort.name,this.sort.Va);a.sort&&b.Da(a.sort.name,a.sort.Va);this.pb&&b.P(this.ya);this.ob&&b.ia(this.xa);a.pb&&b.P(a.ya);a.ob&&b.ia(a.xa);a.sort&&b.Da(a.sort);for(var c in this.D)b.D[c]=this.D[c];for(c in a.D)b.D[c]=a.D[c];return b};Framework.f.prototype.intersection=Framework.f.prototype.intersection;Framework.f.prototype.sa=function(a,b){this.D[a]=b};Framework.f.prototype.setField=Framework.f.prototype.sa;
Framework.f.prototype.F=function(a){return this.D[a]};Framework.f.prototype.getField=Framework.f.prototype.F;Framework.f.prototype.getUrl=function(){return"override me"};Framework.f.prototype.pa=function(){return this.xa};Framework.f.prototype.getPageNumber=Framework.f.prototype.pa;Framework.f.prototype.qa=function(){return this.ya};Framework.f.prototype.getPageSize=Framework.f.prototype.qa;Framework.m=Framework.a.extend({initialize:function(a){Framework.a.prototype.initialize.call(this,a);this.source=a.source;this.source.subscribe(this)},destroy:function(){this.source.unsubscribe(this);Framework.a.prototype.destroy.call(this)}});n("Framework.AbstractConstraintPanel",Framework.m);Framework.m.prototype.getConstraintModel=function(){return new this.source.ConstraintModelPrototype};Framework.m.prototype.F=function(){return this.source};Framework.m.prototype.getSource=Framework.m.prototype.F;
Framework.m.prototype.v=function(){this.trigger("constraintPanel:changed",this)};Framework.m.prototype.onConstraintChange=Framework.m.prototype.v;Framework.Fa=Framework.a.extend({events:{"click #clear":"onClear","click #selectAll":"onSelectAll","click #indicator":"onIndicator","click #clearOnPage":"onClearOnPage","click #clearOnPageAll":"onClearOnPage"},qc:function(){console.log("on indicator")},Kb:function(){this.b.Qa()},lc:function(){this.b.ub()},zc:function(){this.b.Vb()},ea:[],Wb:"selected",update:function(){this.b.source.getAll(null,function(a){var b=Object.keys(this.b.h).length;this.$("#indicator, #selectAll, #clear, #clearOnPage, #clearOnPageAll, .fw-rsp-at-least-one").hide();
0<b&&(this.$("#indicator, .fw-rsp-at-least-one").show(),this.$("#indicator").html(b+" "+this.Wb),this.$("#clear").show());for(var c=!0,d=!0,e=a.length-1;0<=e&&(d||c);e--)this.b.h[a[e][this.b.id]]?d=!1:c=!1;0<a.length&&(d?this.$("#selectAll").show():d||c||this.$("#clearOnPage").show(),c&&this.$("#clearOnPageAll").show());this.tb&&this.tb(this.b.h,b)}.bind(this))},initialize:function(a){this.options=a?a:{};this.b=this.options.parent},render:function(){this.callbacks={};this.wa={};this.$("#indicator, #clear, #clearOnPage, #clearOnPageAll, .fw-rsp-at-least-one").hide();
for(var a=0,b=this.ea.length;a<b;a++){var c=this.ea[a].id;this.callbacks[c]=this.ea[a].Z;this.wa[c]=this.ea[a].wa;this.$(c).on("click",function(a){a="#"+$(a.currentTarget)[0].id;this.callbacks[a](this.b.h,this);this.wa[a]||this.Kb()}.bind(this))}}});n("Framework.AbstractRecordSelectionPanel",Framework.Fa);Framework.T=Framework.m.extend({name:"abstractViewer",Cc:"uuid",events:{keyup:"onKeyup",dragover:"onDragover",dragenter:"onDragenter",drop:"onDrop",mousedown:"onMousedown",mouseup:"onMouseup","mouseover .fw-record":"onMouseover","mouseleave .fw-record":"onMouseleave","mousedown .fw-record":"onClick","change .fw-checkbox":"toggleCheckbox",mousemove:"onMousemove",mouseleave:"onMouseup"},oc:function(a){a.preventDefault();a.stopPropagation()},nc:function(a){a.preventDefault();a.stopPropagation()},pc:function(a){a.originalEvent.dataTransfer&&
a.originalEvent.dataTransfer.files.length&&(a.preventDefault(),a.stopPropagation(),this.trigger("files",a.originalEvent.dataTransfer.files))},rc:function(){},Ja:function(a,b,c){this.$(".fw-record").removeClass("fw-row-selected");c?this.trigger("unselected"):(a.addClass("fw-row-selected"),this.trigger("selected",b))},mc:function(a){var b=$(a.currentTarget),c=$(a.target);if(c.hasClass("fw-checkbox-specific")||c.hasClass("k6-action"))return!0;var c=b.data("id"),d=this.W(c),e=Date.now();this.R?this.R.id==
c&&400>e-this.R.time?(this.trigger("dblclick",d),this.R=null):(this.b.ha&&this.Ja(b,d,a.ctrlKey),this.trigger("click",d),this.R={id:c,Sb:d,time:e}):(this.R={id:c,Sb:d,time:e},this.b.ha&&this.Ja(b,d,a.ctrlKey),this.trigger("click",d))},Mb:function(a){if(this.g){this.g.ka.css({width:Math.max(a.clientX,this.g.x)-Math.min(a.clientX,this.g.x),height:Math.max(a.clientY,this.g.y)-Math.min(a.clientY,this.g.y),left:a.clientX<this.g.x?a.clientX:this.g.x,top:a.clientY<this.g.y?a.clientY:this.g.y});a=this.$(".fw-record");
this.g.ctrlKey||(a.removeClass("fw-selected"),this.parent.h={});for(var b=this.g.ka[0].getBoundingClientRect(),c=0,d=a.length;c<d;c++){var e=a[c],f=e.getBoundingClientRect();if(!(f.right<b.left||f.left>b.right||f.bottom<b.top||f.top>b.bottom)){var e=$(e),f=e.data("id"),g={};g[this.parent.id]=f;g=_.findWhere(this.Y,g);this.parent.h[f]=g;e.addClass("fw-selected")}}this.trigger("viewer:change");this.parent.trigger("selectionChanged")}},sc:function(a){if(this.b&&"drag"==this.b.J){var b=$("<div>");this.g=
{x:a.clientX,y:a.clientY,ka:b,ctrlKey:a.ctrlKey};b.css({position:"fixed",left:this.g.x+"px",top:this.g.y+"px",width:"1px",height:"1px",border:"2px solid yellow"});this.$el.append(b);a=b[0].getBoundingClientRect();for(var c=this.$(".fw-selected"),d=0,e=c.length;d<e;d++){var f=c[d],g=f.getBoundingClientRect();g.right<a.left||g.left>a.right||g.bottom<a.top||g.top>a.bottom||(f=$(f),g=f.data("id"),this.g.ctrlKey&&(f.removeClass("fw-selected"),delete this.parent.h[g],this.g=null,b.remove(),this.trigger("viewer:change"),
this.parent.trigger("selectionChanged")))}}},vc:function(a){this.Mb(a);this.g&&this.g.ka.remove();this.g=null},uc:function(a){a=$(a.currentTarget).data("id");this.trigger("mouseover",this.W(a))},tc:function(a){a=$(a.currentTarget).data("id");this.trigger("mouseleave",this.W(a))},focus:function(){console.log("focus not implemented")},ec:function(){},W:function(a){for(var b=0,c=this.Y.length;b<c;b++)if(this.Y[b][this.parent.id]==a)return this.Y[b];return null},Ec:function(a){a.originalEvent.preventDefault();
a=$(a.currentTarget);var b=a.data("id");a.prop("checked")?this.parent.h[b]=this.W(b):delete this.parent.h[b];this.trigger("viewer:change");this.parent.trigger("selectionChanged");return!1},Pb:function(){this.$(".abstract-viewer-overlay").remove();this.$el.append('<div class="abstract-viewer-overlay"></div>')},Bc:function(){this.$(".abstract-viewer-overlay").remove()},Ua:function(){this.Pb()},render:function(){"drag"==this.b.J&&this.$el.css({"-webkit-touch-callout":"none","-webkit-user-select":"none",
"-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"})},initialize:function(a){a=a?a:{};Framework.m.prototype.initialize.call(this,a);this.A=a.A;this.parent=a.parent},ib:function(){"checkbox"!=this.parent.J&&this.$(".fw-checkbox-specific").remove();if(this.b.oa)for(var a=this.$(".fw-record"),b=0,c=a.length;b<c;b++){var d=$(a[b]),e=d.data("id");this.b.oa==e&&d.addClass("fw-row-selected")}if("drag"==this.parent.J)for(a=this.$(".fw-record"),b=0,c=a.length;b<
c;b++)d=$(a[b]),e=d.data("id"),this.parent.h[e]&&d.addClass("fw-selected");else if("checkbox"==this.parent.J)for(a=this.$(".fw-checkbox"),b=0,c=a.length;b<c;b++)d=$(a[b]),e=d.data("id"),this.parent.h[e]&&(d.addClass("fw-selected"),d.attr("checked","true"));this.Ra=!1},show:function(a){this.Y=records;this.B(this.ib.bind(this),{h:this.parent.h,data:a,id:this.parent.id,A:this.parent.A,selected:this.parent.cc,ha:this.b.ha,J:this.parent.J})}});n("Framework.AbstractViewer",Framework.T);
Framework.Ia=Framework.T.extend({initialize:function(a){Framework.T.prototype.initialize.call(this,a);this.listenTo(this.source,"source:constraintChange",this.v);this.listenTo(this.source,"source:refresh",this.v)},v:function(){this.B()}});n("Framework.Viewer",Framework.Ia);Framework.Ia.prototype.preloadDataAsync=function(a){this.Ua();this.source.get(a)};$.fn.za=function(a,b){b=$.extend({i:10,fa:10,w:0,I:0,Hb:"#",Ba:"Prev",va:"Next",ba:"...",Rb:!1,Jb:!1,Z:function(){return!1}},b||{});this.each(function(){function c(){var c=Math.ceil(b.fa/2),d=Math.ceil(a/b.i),e=d-b.fa;return[f>c?Math.max(Math.min(f-c,e),0):0,f>c?Math.min(f+c,d):Math.min(b.fa,d)]}function d(a,c){f=a;e();var d=b.Z(a,g);d||(c.stopPropagation?c.stopPropagation():c.cancelBubble=!0);return d}function e(){function e(a,c){a=0>a?0:a<m?a:m-1;c=$.extend({text:a+1,aa:""},c||{});var d=a==f?$("<li class='active'><a href='#'>"+
c.text+"</a></li>"):$("<li><a>"+c.text+"</a></li>").bind("click",p(a)).attr("href",b.Hb.replace(/__id__/,a));c.aa&&d.addClass(c.aa);g.append(d)}function p(a){return function(b){return d(a,b)}}g.empty();var l=c(),m=Math.ceil(a/b.i);b.Ba&&(0<f||b.Rb)&&e(f-1,{text:b.Ba,aa:"prev"});if(0<l[0]&&0<b.I){for(var q=Math.min(b.I,l[0]),k=0;k<q;k++)e(k);b.I<l[0]&&b.ba&&$("<li class='disabled'><a href='#'>"+b.ba+"</a></li>").appendTo(g)}for(k=l[0];k<l[1];k++)e(k);if(l[1]<m&&0<b.I)for(m-b.I>l[1]&&b.ba&&$("<li class='disabled'><a href='#'>"+
b.ba+"</a></li>").appendTo(g),k=Math.max(m-b.I,l[1]);k<m;k++)e(k);b.va&&(f<m-1||b.Jb)&&e(f+1,{text:b.va,aa:"next"})}var f=b.w;a=!a||0>a?1:a;b.i=!b.i||0>b.i?1:b.i;var g=$(this);this.nextPage=function(){return f<Math.ceil(a/b.i)-1?(d(f+1),!0):!1};e();b.Z(f,this)})};Framework.U=Framework.m.extend({gb:[10,20,30,50,100,1E3],fb:10,$a:null,events:{"click [id^='pageSize_']":"onPageSize","click #nextPage":"onNextPage","click #previousPage":"onPreviousPage"},xc:function(a){this.P(a.currentTarget.id.split("_")[1]);this.v()},P:function(a){this.$("#itemsPerPage").html(a);this.s.w=0;this.s.i=Number(a);this.$("#paginationPanel").za(this.source.G(),this.s)},reset:function(){this.s.w=0;this.$("#paginationPanel").za(this.source.G(),this.s)},ua:function(a){this.s.w!=a&&(this.s.w=
a,this.v())},ta:function(){this.j=new this.source.ConstraintModelPrototype;this.j.P(this.s.i);this.j.ia(this.s.w);return this.j},initialize:function(a){Framework.m.prototype.initialize.call(this,a);this.options=a?a:{};this.i=a.i;this.S=a.S;this.S||(this.S=this.gb);this.i||(this.i=this.fb);this.s={Z:this.ua.bind(this),w:0,Ba:"",va:"",i:this.i,fa:4,I:1};this.listenTo(this.source,"source:constraintChange",this.update);this.listenTo(this.source,"source:refresh",this.update)},kc:function(){var a=this.$("#itemsPerPageMenu");
a.empty();for(var b=0,c=this.S.length;b<c;b++){var d=this.S[b],d=$('<li><a id="pageSize_'+d+'" role="menuitem">'+d+"</a></li>");a.append(d)}this.$("#itemsPerPage").html(this.i)},wc:function(){this.ua(this.s.w+1)},yc:function(){this.ua(this.s.w-1)},update:function(){this.source.getAll(null,function(){this.$("#previousPage,#nextPage").css("visibility","visible");var a=this.s.w;0==a&&this.$("#previousPage").css("visibility","hidden");var b=Number(this.s.i),c=this.source.G(),d=(a+1)*b,d=d>c?c:d,a=1+a*
b,a=a>c?c:a;d==c&&this.$("#nextPage").css("visibility","hidden");d=a+"-"+d+" OF "+c;this.$a&&(d+=" IN "+this.$a);this.$("#paginationPanel").za(this.source.G(),this.s);this.$("#paginationCount").html(d);0==c?this.$("#paginationCount").css("visibility","hidden"):this.$("#paginationCount").css("visibility","visible")}.bind(this))},B:function(a,b){var c=function(){this.$el.html("unable to get count for paginationPanel")}.bind(this);this.source.getAll(null,function(){Framework.m.prototype.B.call(this,
function(){this.update();a&&a()}.bind(this),b)}.bind(this),c)}});n("Framework.PaginationPanel",Framework.U);
Framework.Ha=Framework.U.extend({events:{"click #more":"_more"},jb:function(a){var b=$(window).height(),c=$(window).scrollTop(),d=$(a).offset().top;a=$(a).height();return d<1.2*(b+c)&&d>c-a},initialize:function(a){Framework.m.prototype.initialize.call(this,a);setInterval(this.nb.bind(this),500)},Ya:function(){},ta:function(){this.j=new this.source.ConstraintModelPrototype;this.j.P(this.Ga);this.j.ia(this.nextPage);return this.j},Na:function(){this.source.getAll(null,function(){this.source.G()<=(this.nextPage+
1)*this.Ga?this.$el.hide():this.na=!1}.bind(this))},mb:function(){this.nextPage++;this.v();this.Na()},nb:function(){0<this.$("#more").length||!this.jb(this.el)||this.na||(this.na=!0,this.mb())},update:function(){},reset:function(){this.na=!1;this.nextPage=0;this.$el.show()},render:function(){this.Na()},Ga:8,nextPage:0});n("Framework.ScrollPaginationPanel",Framework.Ha);Framework.o=Backbone.View.extend({dataType:"json",url:null,initialize:function(){this.j=new this.ConstraintModelPrototype;this.O={};this.u={};this.cache={};this.ra={};this.Qb={};this.X={};this.Ta=!1;if(!this.url)throw"this.url must be defined";},subscribe:function(a){this.O[a.cid]=a;a instanceof Framework.Ha&&(this.kb=!0);this.listenTo(a,"constraintPanel:changed",this.Lb)},unsubscribe:function(a){delete this.O[a.cid]},Ya:function(a){this.j=a;for(var b in this.O)this.O[b].Ya(this.j)},Ka:function(a){var b=
new this.ConstraintModelPrototype,c;for(c in this.O){var d=this.O[c];a&&d instanceof Framework.U&&(this.M=null,d.reset());b=b.intersection(d.getConstraintModel())}return b},Lb:function(a){var b=!(a instanceof Framework.U);b&&(this.M=null);b=this.Ka(b);this.Yb(b,a)},gc:function(){this.cache={}},Yb:function(a,b){this.Xb(a);this.trigger("source:constraintChange",b)},Xb:function(a){this.j=a;"POST"==this.ConstraintModelPrototype.prototype.type?this.Aa=JSON.stringify(a.Sa()):this.j.getUrl()},G:function(){return this.count},
getAll:function(a,b,c){a="";(this.j=this.Ka())&&"GET"==this.ConstraintModelPrototype.prototype.type&&(a="?"+this.j.getUrl());var d=this.url+a;this.ra[d]&&(this.count=this.ra[d]);null==this.cache[d]||this.La&&this.La!=this.Aa?this.X[d]?(this.u[d]||(this.u[d]=[]),this.u[d].push(b)):(this.X[d]=!0,this.u[d]=[],this.u[d].push(b),this.N&&(this.N.url&&(this.u[d]=this.u[this.N.url].concat(this.u[d]),delete this.u[this.N.url]),this.N.abort()),this.N=$.ajax({headers:{cb:"application/json"},cache:!1,contentType:"application/json",
type:this.hc,processData:!1,url:d,dataType:this.dataType,data:this.Aa,success:function(a){this.Ta||(this.Qb[d]=a);this.Ca&&this.Ca(a);if(this["parse__"+this.url])this["parse__"+this.url](a);else this.parse&&(a=this.parse(a));var b=function(a){this.X[d]=!1;this.kb&&(this.M||(this.M=[]),a=this.M=this.M.concat(a));this.La=this.Aa;this.Ta||(this.cache[d]=a,this.ra[d]=this.count);for(var b=0,c=this.u[d].length;b<c;b++)this.u[d][b](a);this.u[d]=[]}.bind(this);if(this["parseAsync__"+this.url])this["parse__"+
this.url](a);else this.parseAsync?this.parseAsync(a,function(a){b(a)}.bind(this)):b(a)}.bind(this),error:function(a){this.X[d]=!1;"abort"!=a.statusText&&(c?c(a):(console.log("error:"),console.log(a)))}.bind(this)}),this.N.url=d):b(this.cache[d])},destroy:function(){console.log("destroying source")},refresh:function(){this.cache={};this.trigger("source:refresh")}});n("Framework.RestSource",Framework.o);Framework.o.prototype.ta=function(){return this.j};Framework.o.prototype.getConstraintModel=Framework.o.prototype.ta;
Framework.o.prototype.ConstraintModelPrototype=Framework.f;Framework.o.prototype.get=function(a,b){this.getAll(null,a,b)};Framework.o.prototype.get=Framework.o.prototype.get;Framework.o.prototype.Ca=function(a){this.count=a};Framework.o.prototype.setCount=Framework.o.prototype.Ca;Framework.o.prototype.G=function(){return this.count};Framework.o.prototype.getCount=Framework.o.prototype.G;Framework.hb=Framework.a.extend({el:"#sourceView",Tb:null,c:[Framework.T],Ub:Framework.Fa,id:"uuid",H:"undefined",J:"checkbox",fc:{},ha:!1,A:null,initialize:function(a){a=a?a:{};this.h={};Framework.a.prototype.initialize.call(this,a);a.H&&(this.H=a.H);this.A=a.A;this.source=a.source;this.Pa=a.Pa;this.da("recordSelectionPanel",this.Ub);this.source&&(this.listenTo(this.source,"source:constraintChange",this.v),this.listenTo(this.source,"source:refresh",function(){this.v(!0)}.bind(this)));for(a=this.c.length-
1;0<=a;a--)this.da(this.c[a].prototype.name,this.c[a],{h:this.h,A:this.A,parent:this,source:this.source}),this.listenTo(this[this.c[a].prototype.name],"dblclick",this.zb),this.listenTo(this[this.c[a].prototype.name],"click",this.yb),this.listenTo(this[this.c[a].prototype.name],"selected",this.Db),this.listenTo(this[this.c[a].prototype.name],"unselected",this.Eb),this.listenTo(this[this.c[a].prototype.name],"files",this.Ab),this.listenTo(this[this.c[a].prototype.name],"mouseover",this.Cb),this.listenTo(this[this.c[a].prototype.name],
"mouseleave",this.Bb),this.listenTo(this[this.c[a].prototype.name],"viewer:change",this.ca),this.listenTo(this[this.c[a].prototype.name],"viewer:setRecord",this.Fb);if(!this[this.H]&&0<this.c.length){if(this.H)throw"unresolved initialView: "+this.H;throw"initial view must be either passed in the viewer or defined in the extended view i.e: window.YourView = SourceView.extend({ initialView : 'grid' }) // where 'grid' resolves to GridViewer.prototype.name";}},Cb:function(a){this.trigger("mouseover",
a)},Bb:function(a){this.trigger("mouseleave",a)},zb:function(a){this.trigger("dblclick",a)},yb:function(a){this.trigger("click",a)},Ab:function(a){this.trigger("files",a)},Db:function(a){this.oa=a[this.id];this.$("#viewer_holder").focusin();this.trigger("selected",a)},Eb:function(){this.oa=null;this.trigger("unselected")},Fb:function(a){this.vb=a;this.trigger("viewer:setRecord",a)},vb:null,Dc:function(a){this.A=a;this.v()},Vb:function(){this.source.getAll(null,function(a){for(var b=a.length-1;0<=
b;b--)this.h[a[b][this.id]]=a[b];this.ca();this.l&&this.l.show(a);this.trigger("selectionChanged")}.bind(this))},Qa:function(){for(var a in this.h)delete this.h[a];this.trigger("selectionCleared");this.qb()},qb:function(){this.ca();this.source&&this.source.getAll(null,function(a){this.l&&this.l.show(a)}.bind(this))},ub:function(){this.source.getAll(null,function(a){for(var b=a.length-1;0<=b;b--)delete this.h[a[b][this.id]];this.ca();this.l.show(a)}.bind(this))},v:function(a){this.bc||(this.Pa&&this.Qa(),
this.l&&(this.l.Ua(),this.$("#viewerProgressBar").show(),this.source.getAll(null,function(b){this.$("#viewerProgressBar").hide();this.Za.update();this.l.show(b);a&&this.l.$(".fw-row-selected").trigger("mousedown");this.ab()}.bind(this))))},render:function(){var a=$('<div id="viewer_holder" tabindex="1" style="outline:none;position: relative; height: 100%;width:100%;overflow-x: hidden;overflow-y: hidden; display: block;">');this.$el.empty();this.$el.append('<div id="viewerProgressBar" class="progress" style="display:none;margin-bottom: -6px;margin-top: 2px;"><div class="indeterminate"></div></div>');
this.$el.append(a);for(var b=this.c.length-1;0<=b;b--){var c=$('<div style="height: 100%;" id="'+this.c[b].prototype.name+'" class="record_viewer"></div>');a.append(c);this[this.c[b].prototype.name].setElement(c)}$el=this.Tb;$el||($el=$('<div id="viewerRecordSelectionPanelEl">'),this.$el.prepend($el));this.Za.setElement($el).B();this.xb(this.H);this.Xa={};$(document).on("keydown",function(a){a=a||window.event;this.Xa[a.keyCode]=!0}.bind(this));$(document).on("keyup",function(a){a=a||window.event;
delete this.Xa[a.keyCode]}.bind(this))},ca:function(){this.Za.update();this.ab()},xb:function(a){this.bb(a);this.l&&this.l.focus()},ab:function(){for(var a=this.c.length-1;0<=a;a--)this.l!=this[this.c[a].prototype.name]&&(this[this.c[a].prototype.name].Ra=!0)},bb:function(a){this.l=this[a];for(var b=this.c.length-1;0<=b;b--)this.$("#"+this.c[b].prototype.name).hide();this.$("div#"+a).show();this.l&&this.l.Ra&&this.source.getAll(null,function(a){this.l.show(a)}.bind(this));this.trigger("sourceView:change",
a)}});n("Framework.SourceView",Framework.hb);Framework.C=Framework.a.extend({initialize:function(a){Framework.a.prototype.initialize.call(this,a);this.Ma={}},events:{"click .fw-tab-toggle":"otc"},rb:function(a){var b=$(a.currentTarget);a=b[0].id;this.ga&&this.setParameter(this.ga,a);var c=b.data("viewconstructor"),d=this.$('.fw-tab-content[data-id="'+a+'"]'),e=this.$('.fw-tab-content[data-for="'+a+'"]');if(0==d.length)throw"corresponding div does not exist";this.$(".fw-tab-toggle").removeClass("active");b.addClass("active");this.$(".fw-tab-content").hide();
d.show();e.show();if(!this.Ma[a]){this.Ma[a]=!0;b=null;if(c&&window[c])b=window[c];else throw"constructor "+c+" does not exist";this.da("content_"+a,b,{});this["content_"+a].setElement(d).B()}this.trigger("tab:"+a)},render:function(){this.$(".fw-tab-content").hide();this.ga&&this.getParameter(this.ga)?this.Ea(this.getParameter(this.ga)):(this.$(".fw-tab-toggle.active").click(),this.la.Ob&&this.Ea(this.la.Ob))}});n("Framework.TabView",Framework.C);Framework.C.prototype.otc=function(a){this.rb(a)};
Framework.C.prototype.F=function(a){this.$(this.$(".fw-tab-toggle")[a]).click()};Framework.C.prototype.setTabByIndex=Framework.C.prototype.F;Framework.C.prototype.Ea=function(a){this.$(".fw-tab-toggle#"+a).click()};Framework.C.prototype.setTabById=Framework.C.prototype.Ea;Framework.Zb=Framework.a.extend({initialize:function(a){Framework.a.prototype.initialize.call(this,a);this.ja=a.ja;if(!this.ja)throw"you must specify sourceView parameter in options.";this.listenTo(this.ja,"sourceView:change",this.Nb)},Nb:function(){},events:{"click .view-toggle":"onViewToggle"},Ac:function(a){a=$(a.currentTarget).data("viewer");this.ja.bb(a)},render:function(){}});
